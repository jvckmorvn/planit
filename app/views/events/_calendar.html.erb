<% style = params[:event_id].present? ? "background-color: #{events&.first&.colour};" : "" %>
<div data-select-event-target="eventCalendar" style="<%= style %>">
  <%= month_calendar do |date| %>
    <%= date.day %>
      <div class="day-popup bubblePosition hoverBubble">
        Click to vote on this day.
      </div>
    <% events.each do |event| %>
      <% event.days.each do |event_day| %>
        <% if event_day.day_date == date %>
          <p><%= link_to event.name, day_day_vote_index_path(event_day), data: {turbo_method: :post} %>: <div class="event-marker" style="background-color: <%= event.colour %>; opacity: <%= event_day.day_votes.count > 0 ? (event_day.day_votes.count.to_f / event_day.event.group.users.count.to_f) : 0 %>"></div></p>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</div>
<%# Implemented event marker feature %>
